<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Build Process &#8212; Knora 0.1 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Setup IntelliJ for development of Knora" href="intellij-config.html" />
    <link rel="prev" title="Starting GraphDB-SE" href="graphdb.html" /> 
  </head>
  <body role="document">
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="../../index.html">Knora 0.1 documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="graphdb.html" title="Starting GraphDB-SE"
             accesskey="P">previous</a> |
          <a href="intellij-config.html" title="Setup IntelliJ for development of Knora"
             accesskey="N">next</a> |
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="build-process">
<span id="webapi-build-process"></span><h1>Build Process<a class="headerlink" href="#build-process" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#building-and-running" id="id2">Building and Running</a><ul>
<li><a class="reference internal" href="#using-fuseki" id="id3">Using Fuseki</a></li>
<li><a class="reference internal" href="#using-graphdb" id="id4">Using GraphDB</a></li>
</ul>
</li>
<li><a class="reference internal" href="#running-the-automated-tests" id="id5">Running the automated tests</a><ul>
<li><a class="reference internal" href="#running-tests-with-fuseki" id="id6">Running Tests with Fuseki</a></li>
<li><a class="reference internal" href="#running-tests-with-graphdb" id="id7">Running Tests with GraphDB</a></li>
</ul>
</li>
<li><a class="reference internal" href="#load-testing-on-mac-os-x" id="id8">Load Testing on Mac OS X</a></li>
<li><a class="reference internal" href="#continuous-integration" id="id9">Continuous Integration</a></li>
<li><a class="reference internal" href="#sbt-build-configuration" id="id10">SBT Build Configuration</a></li>
<li><a class="reference internal" href="#webapi-server-startup-flags" id="id11">Webapi Server Startup-Flags</a><ul>
<li><a class="reference internal" href="#loaddemodata-flag" id="id12"><code class="docutils literal"><span class="pre">loadDemoData</span></code> - Flag</a></li>
<li><a class="reference internal" href="#allowresettriplestorecontentoperationoverhttp-flag" id="id13"><code class="docutils literal"><span class="pre">allowResetTriplestoreContentOperationOverHTTP</span></code> - Flag</a></li>
</ul>
</li>
</ul>
</div>
<dl class="docutils">
<dt>TODO: complete this file.</dt>
<dd><ul class="first last simple">
<li>SBT</li>
<li>Using GraphDB for development and how to initializing the &#8216;knora-test-unit&#8217; repository</li>
<li>Using Fuseki for development</li>
</ul>
</dd>
</dl>
<div class="section" id="building-and-running">
<h2><a class="toc-backref" href="#id2">Building and Running</a><a class="headerlink" href="#building-and-running" title="Permalink to this headline">¶</a></h2>
<div class="section" id="using-fuseki">
<h3><a class="toc-backref" href="#id3">Using Fuseki</a><a class="headerlink" href="#using-fuseki" title="Permalink to this headline">¶</a></h3>
<p>Start the provided Fuseki triplestore:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ cd KNORA_PROJECT_DIRECTORY/triplestores/fuseki
$ ./fuseki-server
</pre></div>
</div>
<p>Then in another terminal, load some test data into the triplestore:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ cd KNORA_PROJECT_DIRECTORY/webapi/scripts
$ ./fuseki-load-test-data.sh
</pre></div>
</div>
<p>Then go back to the webapi root directory and use SBT to start the API server:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ cd KNORA_PROJECT_DIRECTORY/webapi
$ sbt
&gt; compile
&gt; re-start
</pre></div>
</div>
<p>To shut down the Knora API server:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">re</span><span class="o">-</span><span class="n">stop</span>
</pre></div>
</div>
</div>
<div class="section" id="using-graphdb">
<h3><a class="toc-backref" href="#id4">Using GraphDB</a><a class="headerlink" href="#using-graphdb" title="Permalink to this headline">¶</a></h3>
<p>The archive with the newest supported version of the GraphDB-SE triplestore is provided under
<code class="docutils literal"><span class="pre">`triplestores/graphdb-se-7`</span></code>. Please keep in mind, that GraphDB-SE must be licensed separately by the user, and that
no license file is provided in the repository. GraphDB-SE will not run without a license file.</p>
<p>To be able to successfully run GraphDB inside docker three important steps need to be done beforhand:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Install Docker from <a class="reference external" href="http://docker.com">http://docker.com</a>.</li>
<li>Copy the GraphDB-SE license file into this folder and name it <code class="docutils literal"><span class="pre">GRAPHDB_SE.license</span></code>. It is already added to a
local <code class="docutils literal"><span class="pre">.gitignore</span></code> file which can be found inside this folder. Under no circumstance should the license file be
committed to Github.</li>
<li>(optional) The current version of <code class="docutils literal"><span class="pre">KnoraRules.pie</span></code> from the <code class="docutils literal"><span class="pre">webapi/scripts</span></code> needs to be copied to this folder
each time it was changed. This file needs to be copied into the docker image, which can only be done if it is found
inside this folder.</li>
</ol>
</div></blockquote>
<p>From inside this folder, type:</p>
<p><code class="docutils literal"><span class="pre">`</span>
<span class="pre">$</span> <span class="pre">docker</span> <span class="pre">build</span> <span class="pre">-t</span> <span class="pre">graphdb</span> <span class="pre">.</span>
<span class="pre">$</span> <span class="pre">docker</span> <span class="pre">run</span> <span class="pre">--rm</span> <span class="pre">-it</span> <span class="pre">-p</span> <span class="pre">7200:7200</span> <span class="pre">graphdb</span>
<span class="pre">`</span></code></p>
<p>Do not forget the &#8216;.&#8217; in the first command.</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">`--rm`</span></code> removes the container as soon as you stop it</li>
<li><code class="docutils literal"><span class="pre">`-p`</span></code> forwards the exposed port to your host (or if you use boot2docker to this IP)</li>
<li><code class="docutils literal"><span class="pre">`-it`</span></code> allows interactive mode, so you see if something get&#8217;s deployed</li>
</ul>
</div></blockquote>
<p>After the GraphDB inside the docker container has started, you can find the GraphDB workbench here: <a class="reference external" href="http://localhost:7200">http://localhost:7200</a></p>
</div>
</div>
<div class="section" id="running-the-automated-tests">
<h2><a class="toc-backref" href="#id5">Running the automated tests</a><a class="headerlink" href="#running-the-automated-tests" title="Permalink to this headline">¶</a></h2>
<div class="section" id="running-tests-with-fuseki">
<h3><a class="toc-backref" href="#id6">Running Tests with Fuseki</a><a class="headerlink" href="#running-tests-with-fuseki" title="Permalink to this headline">¶</a></h3>
<p>Make sure you&#8217;ve started Fuseki as shown above. Then at the SBT prompt:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">fuseki</span><span class="p">:</span><span class="n">test</span>
</pre></div>
</div>
</div>
<div class="section" id="running-tests-with-graphdb">
<h3><a class="toc-backref" href="#id7">Running Tests with GraphDB</a><a class="headerlink" href="#running-tests-with-graphdb" title="Permalink to this headline">¶</a></h3>
<p>Make sure GraphDB is running. Then at the SBT prompt:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">graphdb</span><span class="p">:</span><span class="n">test</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="load-testing-on-mac-os-x">
<h2><a class="toc-backref" href="#id8">Load Testing on Mac OS X</a><a class="headerlink" href="#load-testing-on-mac-os-x" title="Permalink to this headline">¶</a></h2>
<p>To test the Knora API server with many concurrent connections on Mac OS X, you
will need to adjust some kernel parameters to allow more open connections, to
recycle ephemeral ports more quickly, and to use a wider range of ephemeral
port numbers. The script <code class="docutils literal"><span class="pre">webapi/scripts/os-x-kernel-test-config.sh</span></code> will do
this.</p>
</div>
<div class="section" id="continuous-integration">
<h2><a class="toc-backref" href="#id9">Continuous Integration</a><a class="headerlink" href="#continuous-integration" title="Permalink to this headline">¶</a></h2>
<p>For continuous integration testing, we use Travis-CI. Every commit pushed to the git repository or every
pull request, triggers the build. Additionaly, in Github there is a litle checkmark beside every commit, signaling the
status of the build (successful, unsucessful, ongoing).</p>
<p>The build that is executed on Travis-CI is defined in <code class="docutils literal"><span class="pre">.travis.yml</span></code> situated in the root folder of the project, and
looks like this:</p>
<div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">sudo</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">required</span>
<span class="l l-Scalar l-Scalar-Plain">git</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">depth</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="l l-Scalar l-Scalar-Plain">language</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">scala</span>
<span class="l l-Scalar l-Scalar-Plain">scala</span><span class="p p-Indicator">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">2.11.7</span>
<span class="l l-Scalar l-Scalar-Plain">jdk</span><span class="p p-Indicator">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">oraclejdk8</span>
<span class="l l-Scalar l-Scalar-Plain">cache</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">directories</span><span class="p p-Indicator">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">$HOME/.ivy2</span>
<span class="l l-Scalar l-Scalar-Plain">script</span><span class="p p-Indicator">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cd triplestores/fuseki/ &amp;&amp; ./fuseki-server &amp;</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cd webapi/ &amp;&amp; sbt test</span>
<span class="l l-Scalar l-Scalar-Plain">notifications</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">slack</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">secure</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">AJZARDC7P6bwjFwk6gpe+p2ozLj+bH3h83PapfCTL0xi7frHd4y6/jXOs9ac+m7ia5FlnzgBxrf0lmaE+IkqlRzxo5dPNYkDIbMC3nrf48kS+uQjf87X1Pn6bDVBLL56L1xIeaEXAqLLWNZ8m1UQ3ykVHgUbUbimjm43eCMpUiretgOqQgreZuLGVxPDU4KrGYZ93FvT2Nzp1Iagld0KXJ1up/uKlpSZAIpJPhgWYIhSGwj9hYG50iENvtsOX/zTe2hjhKWaPmVxHWo8qNyyHfX/+3ODQhvKu3LQsFXbW8WQ1r86EUDrGWeT6mlCYbjR1Wk/7wEKvGts/7vnTNJ8H2xDG9ADc4zIzIpnz0+gndIXuguxuMZEdm1H9okcDqraa4OV01bobr43RVC4hTZCiEBt7wCd/c+C1lJahAQUQoKsbmp5idKrjUyESJ0ZbU6hgkKeOvEvUqv0msYJGWW/C5BlUlro08AgZ9h6nOfu8jJQ49x9QbSWLjTVDg8CEq3w8FDATGA6FKdDqgmsi/3ROjgdewPgyxE3XZ2UpAbAdMPeuGvFoU91X8gScm6ys6abLy0vdCL3LyqmBu/Vzdg1RzU7oqUqSbR5LSMh8pwAwy26j6Awp+pDEzBtyL59yN6r6wgxmbJ5KT+XJReEH6Ao0C6ay23E8T/3YmI3qbjX8xE=</span>
</pre></div>
</td></tr></table></div>
<p>It basically means:</p>
<blockquote>
<div><ul class="simple">
<li>use the virtual machine based environment (line 1)</li>
<li>checkout git with a shorter history (lines 2-3)</li>
<li>add scala libraries (lines 4-6)</li>
<li>add oracle jdk version 8 (lines 7-8)</li>
<li>cache some directories between builds to make it faster (line 9-11)</li>
<li>start fuseki and afterwards start all tests (lines 12-14)</li>
<li>send notification to our slack channel (lines 15-17)</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="sbt-build-configuration">
<h2><a class="toc-backref" href="#id10">SBT Build Configuration</a><a class="headerlink" href="#sbt-build-configuration" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default"><div class="highlight"><pre><span></span>import sbt._
import sbt.Keys._
import spray.revolver.RevolverPlugin._
import com.typesafe.sbt.SbtNativePackager.autoImport._

connectInput in run := true

// Bring the sbt-aspectj settings into this build
//aspectjSettings

lazy val webapi = (project in file(&quot;.&quot;)).
        configs(
            FusekiTest,
            FusekiTomcatTest,
            GraphDBTest,
            GraphDBFreeTest,
            SesameTest,
            EmbeddedJenaTDBTest,
            IntegrationTest
        ).
        settings(webApiCommonSettings:  _*).
        settings(inConfig(FusekiTest)(
            Defaults.testTasks ++ Seq(
                fork := true,
                javaOptions ++= javaFusekiTestOptions,
                testOptions += Tests.Argument(&quot;-oDF&quot;) // show full stack traces and test case durations
            )
        ): _*).
        settings(inConfig(FusekiTomcatTest)(
            Defaults.testTasks ++ Seq(
                fork := true,
                javaOptions ++= javaFusekiTomcatTestOptions,
                testOptions += Tests.Argument(&quot;-oDF&quot;) // show full stack traces and test case durations
            )
        ): _*).
        settings(inConfig(GraphDBTest)(
            Defaults.testTasks ++ Seq(
                fork := true,
                javaOptions ++= javaGraphDBTestOptions,
                testOptions += Tests.Argument(&quot;-oDF&quot;) // show full stack traces and test case durations
            )
        ): _*).
        settings(inConfig(GraphDBFreeTest)(
            Defaults.testTasks ++ Seq(
                fork := true,
                javaOptions ++= javaGraphDBFreeTestOptions,
                testOptions += Tests.Argument(&quot;-oDF&quot;) // show full stack traces and test case durations
            )
        ): _*).
        settings(inConfig(SesameTest)(
            Defaults.testTasks ++ Seq(
                fork := true,
                javaOptions ++= javaSesameTestOptions,
                testOptions += Tests.Argument(&quot;-oDF&quot;) // show full stack traces and test case durations
            )
        ): _*).
        settings(inConfig(EmbeddedJenaTDBTest)(
            Defaults.testTasks ++ Seq(
                fork := true,
                javaOptions ++= javaEmbeddedJenaTDBTestOptions,
                testOptions += Tests.Argument(&quot;-oDF&quot;) // show full stack traces and test case durations
            )
        ): _*).
        settings(inConfig(IntegrationTest)(
            Defaults.itSettings ++ Seq(
                fork := true,
                javaOptions ++= javaIntegrationTestOptions,
                testOptions += Tests.Argument(&quot;-oDF&quot;) // show full stack traces and test case durations
            )
        ): _*).
        settings(
            //javaOptions in FusekiTest ++= javaFusekiTestOptions,
            //javaOptions in FusekiTomcatTest ++= javaFusekiTomcatTestOptions,
            //javaOptions in GraphDBTest ++= javaGraphDBTestOptions,
            //javaOptions in EmbeddedJenaTDBTest ++= javaEmbeddedJenaTDBTestOptions,
            //fork in FusekiTest := true,
            //parallelExecution in FusekiTest := false,
            //testOptions in FusekiTest += Tests.Argument(&quot;-oDF&quot;)
        ).
        settings(
            libraryDependencies ++= webApiLibs,
            scalacOptions ++= Seq(&quot;-feature&quot;, &quot;-unchecked&quot;, &quot;-deprecation&quot;, &quot;-Yresolve-term-conflict:package&quot;),
            logLevel := Level.Info,
            fork in run := true,
            javaOptions in run ++= javaRunOptions,
            //javaOptions in run &lt;++= AspectjKeys.weaverOptions in Aspectj,
            //javaOptions in Revolver.reStart &lt;++= AspectjKeys.weaverOptions in Aspectj,
            mainClass in (Compile, run) := Some(&quot;org.knora.webapi.Main&quot;),
            fork in Test := true,
            javaOptions in Test ++= javaTestOptions,
            parallelExecution in Test := false
        ).
        settings(Revolver.settings: _*).
        enablePlugins(SbtTwirl) // Enable the SbtTwirl plugin

lazy val webApiCommonSettings = Seq(
    organization := &quot;org.knora&quot;,
    name := &quot;webapi&quot;,
    version := &quot;0.1.0&quot;,
    ivyScala := ivyScala.value map { _.copy(overrideScalaVersion = true) },
    scalaVersion := &quot;2.12.1&quot;
)

lazy val akkaVersion = &quot;2.4.16&quot;
lazy val akkaHttpVersion = &quot;10.0.3&quot;

lazy val webApiLibs = Seq(
    // akka
    &quot;com.typesafe.akka&quot; %% &quot;akka-actor&quot; % akkaVersion,
    &quot;com.typesafe.akka&quot; %% &quot;akka-agent&quot; % akkaVersion,
    &quot;com.typesafe.akka&quot; %% &quot;akka-stream&quot; % akkaVersion,
    &quot;com.typesafe.akka&quot; %% &quot;akka-slf4j&quot; % akkaVersion,
    &quot;com.typesafe.akka&quot; %% &quot;akka-http&quot; % akkaHttpVersion,
    &quot;com.typesafe.akka&quot; %% &quot;akka-http-xml&quot; % akkaHttpVersion,
    &quot;com.typesafe.akka&quot; %% &quot;akka-http-spray-json&quot; % akkaHttpVersion,

    &quot;org.scala-lang.modules&quot; %% &quot;scala-xml&quot; % &quot;1.0.6&quot;,

    // testing
    &quot;org.scalatest&quot; %% &quot;scalatest&quot; % &quot;3.0.0&quot; % &quot;test&quot;,
    //CORS support
    &quot;ch.megard&quot; %% &quot;akka-http-cors&quot; % &quot;0.1.10&quot;,
    // jena
    &quot;org.apache.jena&quot; % &quot;apache-jena-libs&quot; % &quot;3.0.0&quot; exclude(&quot;org.slf4j&quot;, &quot;slf4j-log4j12&quot;),
    &quot;org.apache.jena&quot; % &quot;jena-text&quot; % &quot;3.0.0&quot; exclude(&quot;org.slf4j&quot;, &quot;slf4j-log4j12&quot;),
    // http client
    // &quot;net.databinder.dispatch&quot; %% &quot;dispatch-core&quot; % &quot;0.11.2&quot;,
    // logging
    &quot;com.typesafe.scala-logging&quot; %% &quot;scala-logging&quot; % &quot;3.5.0&quot;,
    &quot;ch.qos.logback&quot; % &quot;logback-classic&quot; % &quot;1.1.7&quot;,
    // input validation
    &quot;commons-validator&quot; % &quot;commons-validator&quot; % &quot;1.4.1&quot;,
    // authentication
    &quot;org.bouncycastle&quot; % &quot;bcprov-jdk15on&quot; % &quot;1.56&quot;,
    &quot;org.springframework.security&quot; % &quot;spring-security-core&quot; % &quot;4.2.1.RELEASE&quot;,
    // caching
    &quot;net.sf.ehcache&quot; % &quot;ehcache&quot; % &quot;2.10.0&quot;,
    // monitoring - disabled for now
    //&quot;org.aspectj&quot; % &quot;aspectjweaver&quot; % &quot;1.8.7&quot;,
    //&quot;org.aspectj&quot; % &quot;aspectjrt&quot; % &quot;1.8.7&quot;,
    //&quot;io.kamon&quot; %% &quot;kamon-core&quot; % &quot;0.5.2&quot;,
    //&quot;io.kamon&quot; %% &quot;kamon-spray&quot; % &quot;0.5.2&quot;,
    //&quot;io.kamon&quot; %% &quot;kamon-statsd&quot; % &quot;0.5.2&quot;,
    //&quot;io.kamon&quot; %% &quot;kamon-log-reporter&quot; % &quot;0.5.2&quot;,
    //&quot;io.kamon&quot; %% &quot;kamon-system-metrics&quot; % &quot;0.5.2&quot;,
    //&quot;io.kamon&quot; %% &quot;kamon-newrelic&quot; % &quot;0.5.2&quot;,
    // other
    //&quot;javax.transaction&quot; % &quot;transaction-api&quot; % &quot;1.1-rev-1&quot;,
    &quot;org.apache.commons&quot; % &quot;commons-lang3&quot; % &quot;3.4&quot;,
    &quot;commons-io&quot; % &quot;commons-io&quot; % &quot;2.4&quot;,
    &quot;commons-beanutils&quot; % &quot;commons-beanutils&quot; % &quot;1.9.2&quot;, // not used by us, but need newest version to prevent this problem: http://stackoverflow.com/questions/14402745/duplicate-classes-in-commons-collections-and-commons-beanutils
    &quot;org.jodd&quot; % &quot;jodd&quot; % &quot;3.2.6&quot;,
    &quot;joda-time&quot; % &quot;joda-time&quot; % &quot;2.9.1&quot;,
    &quot;org.joda&quot; % &quot;joda-convert&quot; % &quot;1.8&quot;,
    &quot;com.sksamuel.diff&quot; % &quot;diff&quot; % &quot;1.1.11&quot;,
    &quot;org.xmlunit&quot; % &quot;xmlunit-core&quot; % &quot;2.1.1&quot;,
    // testing
    &quot;com.typesafe.akka&quot; %% &quot;akka-testkit&quot; % akkaVersion % &quot;test, fuseki, fuseki-tomcat, graphdb, tdb, it&quot;,
    &quot;com.typesafe.akka&quot; %% &quot;akka-http-testkit&quot; % akkaHttpVersion % &quot;test, fuseki, fuseki-tomcat, graphdb, tdb, it&quot;,
    &quot;com.typesafe.akka&quot; %% &quot;akka-stream-testkit&quot; % akkaVersion % &quot;test, fuseki, fuseki-tomcat, graphdb, tdb, it&quot;,
    &quot;org.scalatest&quot; %% &quot;scalatest&quot; % &quot;3.0.0&quot; % &quot;test, fuseki, fuseki-tomcat, graphdb, tdb, it&quot;,
    &quot;org.eclipse.rdf4j&quot; % &quot;rdf4j-rio-turtle&quot; % &quot;2.0M3&quot;,
    &quot;org.rogach&quot; %% &quot;scallop&quot; % &quot;2.0.5&quot;,
    &quot;com.google.gwt&quot; % &quot;gwt-servlet&quot; % &quot;2.8.0&quot;,
    &quot;net.sf.saxon&quot; % &quot;Saxon-HE&quot; % &quot;9.7.0-14&quot;
)

lazy val javaRunOptions = Seq(
    // &quot;-showversion&quot;,
    &quot;-Xms2048m&quot;,
    &quot;-Xmx4096m&quot;
    // &quot;-verbose:gc&quot;,
    //&quot;-XX:+UseG1GC&quot;,
    //&quot;-XX:MaxGCPauseMillis=500&quot;
)

lazy val javaTestOptions = Seq(
    // &quot;-showversion&quot;,
    &quot;-Xms2048m&quot;,
    &quot;-Xmx4096m&quot;
    // &quot;-verbose:gc&quot;,
    //&quot;-XX:+UseG1GC&quot;,
    //&quot;-XX:MaxGCPauseMillis=500&quot;,
    //&quot;-XX:MaxMetaspaceSize=4096m&quot;
)

lazy val FusekiTest = config(&quot;fuseki&quot;) extend(Test)
lazy val javaFusekiTestOptions = Seq(
    &quot;-Dconfig.resource=fuseki.conf&quot;
) ++ javaTestOptions

lazy val FusekiTomcatTest = config(&quot;fuseki-tomcat&quot;) extend(Test)
lazy val javaFusekiTomcatTestOptions = Seq(
    &quot;-Dconfig.resource=fuseki-tomcat.conf&quot;
) ++ javaTestOptions

lazy val GraphDBTest = config(&quot;graphdb&quot;) extend(Test)
lazy val javaGraphDBTestOptions = Seq(
    &quot;-Dconfig.resource=graphdb.conf&quot;
) ++ javaTestOptions

lazy val GraphDBFreeTest = config(&quot;graphdb-free&quot;) extend(Test)
lazy val javaGraphDBFreeTestOptions = Seq(
    &quot;-Dconfig.resource=graphdb-free.conf&quot;
) ++ javaTestOptions

lazy val SesameTest = config(&quot;sesame&quot;) extend(Test)
lazy val javaSesameTestOptions = Seq(
    &quot;-Dconfig.resource=sesame.conf&quot;
) ++ javaTestOptions

lazy val EmbeddedJenaTDBTest = config(&quot;tdb&quot;) extend(Test)
lazy val javaEmbeddedJenaTDBTestOptions = Seq(
    &quot;-Dconfig.resource=jenatdb.conf&quot;
) ++ javaTestOptions

// The &#39;IntegrationTest&#39; config does not need to be created here, as it is a built-in config!
// The standard testing tasks are available, but must be prefixed with &#39;it:&#39;, e.g., &#39;it:test&#39;
// The test need to be stored in the &#39;it&#39; (and not &#39;test&#39;) folder. The standard source hierarchy is used, e.g., &#39;src/it/scala&#39;
lazy val javaIntegrationTestOptions = Seq(
    &quot;-Dconfig.resource=graphdb.conf&quot;
) ++ javaTestOptions

// skip test before creating fat-jar
test in assembly := {}

// set fat-jar main class
mainClass in assembly := Some(&quot;org.knora.webapi.Main&quot;)

// change merge strategy for fat-jar
assemblyMergeStrategy in assembly := {
    case PathList(&quot;org&quot;, &quot;apache&quot;, &quot;commons&quot;, &quot;logging&quot;, xs @ _*)   =&gt; MergeStrategy.first
    case PathList(&quot;META-INF&quot;, xs @ _*) =&gt;
    xs.map(_.toLowerCase) match {
        case (&quot;manifest.mf&quot; :: Nil) | (&quot;index.list&quot; :: Nil) | (&quot;dependencies&quot; :: Nil) =&gt;
        MergeStrategy.discard
        case ps @ (x :: xs) if ps.last.endsWith(&quot;.sf&quot;) || ps.last.endsWith(&quot;.dsa&quot;) || ps.last.endsWith(&quot;license&quot;) || ps.last.endsWith(&quot;license.txt&quot;) || ps.last.endsWith(&quot;notice&quot;) || ps.last.endsWith(&quot;notice.txt&quot;) =&gt;
        MergeStrategy.discard
        case &quot;plexus&quot; :: xs =&gt;
        MergeStrategy.discard
        case &quot;services&quot; :: xs =&gt;
        MergeStrategy.filterDistinctLines
        case (&quot;spring.schemas&quot; :: Nil) | (&quot;spring.handlers&quot; :: Nil) =&gt;
        MergeStrategy.filterDistinctLines
        case ps@(x :: xs) if ps.last.endsWith(&quot;aop.xml&quot;) =&gt; MergeStrategy.first
        case _ =&gt; MergeStrategy.deduplicate
    }
    case x =&gt;
    val oldStrategy = (assemblyMergeStrategy in assembly).value
    oldStrategy(x)
}
</pre></div>
</div>
</div>
<div class="section" id="webapi-server-startup-flags">
<span id="id1"></span><h2><a class="toc-backref" href="#id11">Webapi Server Startup-Flags</a><a class="headerlink" href="#webapi-server-startup-flags" title="Permalink to this headline">¶</a></h2>
<p>The Webapi-Server can be started with a number of flags. These flags can be supplied either to the <code class="docutils literal"><span class="pre">reStart</span></code> or the
<code class="docutils literal"><span class="pre">run</span></code> command in sbt, e.g.,:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ sbt
&gt; reStart flag
</pre></div>
</div>
<p>or</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$sbt
&gt; run flag
</pre></div>
</div>
<div class="section" id="loaddemodata-flag">
<h3><a class="toc-backref" href="#id12"><code class="docutils literal"><span class="pre">loadDemoData</span></code> - Flag</a><a class="headerlink" href="#loaddemodata-flag" title="Permalink to this headline">¶</a></h3>
<p>When the webapi-server is started with the <code class="docutils literal"><span class="pre">loadDemoData</span></code> flag, then at startup, the data which is configured in
<code class="docutils literal"><span class="pre">application.conf</span></code> under the <code class="docutils literal"><span class="pre">app.triplestore.rdf-data</span></code> key is loaded into the triplestore, and any data in the
triplestore is removed beforehand.</p>
<p>Usage:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ sbt
&gt; reStart loadDemoData
</pre></div>
</div>
</div>
<div class="section" id="allowresettriplestorecontentoperationoverhttp-flag">
<h3><a class="toc-backref" href="#id13"><code class="docutils literal"><span class="pre">allowResetTriplestoreContentOperationOverHTTP</span></code> - Flag</a><a class="headerlink" href="#allowresettriplestorecontentoperationoverhttp-flag" title="Permalink to this headline">¶</a></h3>
<p>When the webapi.server is started with the <code class="docutils literal"><span class="pre">allowResetTriplestoreContentOperationOverHTTP</span></code> flag, then the
<code class="docutils literal"><span class="pre">v1/store/ResetTriplestoreContent</span></code> route is activated. This route accepts a <code class="docutils literal"><span class="pre">POST</span></code> request, with a json payload
consisting of the following exemplary content:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span>
  <span class="p">{</span>
    <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;../knora-ontologies/knora-base.ttl&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;http://www.knora.org/ontology/knora-base&quot;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;../knora-ontologies/knora-dc.ttl&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;http://www.knora.org/ontology/dc&quot;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;../knora-ontologies/salsah-gui.ttl&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;http://www.knora.org/ontology/salsah-gui&quot;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;_test_data/ontologies/incunabula-onto.ttl&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;http://www.knora.org/ontology/incunabula&quot;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;_test_data/all_data/incunabula-data.ttl&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;http://www.knora.org/data/incunabula&quot;</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>This content corresponds to the payload sent with the <code class="docutils literal"><span class="pre">ResetTriplestoreContent</span></code> message, defined inside the
<code class="docutils literal"><span class="pre">org.knora.webapi.messages.v1.store.triplestoremessages</span></code> package. The <code class="docutils literal"><span class="pre">path</span></code> being the relative path to the <code class="docutils literal"><span class="pre">ttl</span></code>
file which will be loaded into a named graph by the name of <code class="docutils literal"><span class="pre">name</span></code>.</p>
<p>Usage:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ sbt
&gt; reStart allowResetTriplestoreContentOperationOverHTTP
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../knora-ontologies/index.html">The Knora Ontologies</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">The Knora API Server</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../deployment/index.html">Deploying the Knora API Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-documentation/index.html">Knora API Server Design Documentation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Developing the Knora API Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_v1/index.html">Using API V1</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../salsah/index.html">SALSAH</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sipi/index.html">Sipi</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="../../../search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="graphdb.html" title="Starting GraphDB-SE"
              >previous</a> |
            <a href="intellij-config.html" title="Setup IntelliJ for development of Knora"
              >next</a> |
            <a href="../../../genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="../../../_sources/rst/knora-api-server/development/build-process.rst.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &#169; Copyright 2015, Lukas Rosenthaler, Benjamin Geer, Ivan Subotic, Tobias Schweizer, André Kilchenmann, and Sepideh Alassi.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.2.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>